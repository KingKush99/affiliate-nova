function $(s){return document.querySelector(s)}async function run(){let cfg=window.SEARCH;if(!cfg){const q=new URLSearchParams(location.search);cfg={dim:q.get('dim')||'tag',val:q.get('val')||''};}const rooms=await (await fetch('data/rooms.json')).json();let list=rooms.filter(r=>{switch(cfg.dim){case 'age':return r.ageGroup===cfg.val;case 'region':return r.region===cfg.val;case 'rate':return r.rate===cfg.val;case 'status':return r.status===cfg.val;case 'category':return r.category===cfg.val;default:return (r.tags||[]).includes(cfg.val);}});const grid=$('#grid');function render(){const sort=$('#sortBy').value;list.sort((a,b)=>sort==='alpha'?a.name.localeCompare(b.name):(b.viewers||0)-(a.viewers||0));$('#resultCount').textContent=`${list.length} results`;grid.innerHTML=list.map(r=>`<a href="room.html?id=${r.id}" class="rounded-2xl border border-white/10 bg-[#111827] block overflow-hidden"><div class='aspect-video relative'><img src='${r.thumb}' class='absolute inset-0 w-full h-full object-cover opacity-85'></div><div class='p-3'><div class='font-semibold'>${r.name}</div><div class='text-xs text-slate-400 mt-1'>${(r.viewers||0).toLocaleString()} viewers â€¢ ${(r.tags||[]).slice(0,3).join(', ')}</div></div></a>`).join('');}$('#sortBy').addEventListener('change',render);render()}document.addEventListener('DOMContentLoaded',run);